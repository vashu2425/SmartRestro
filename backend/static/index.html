<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Management API Testing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .module-card {
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        .module-card:hover {
            transform: translateY(-5px);
        }
        .response-area {
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }
        .loading {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="text-center mb-5">Kitchen Management API Testing</h1>
        
        <div class="row">
            <!-- Demand Waste Prediction -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">Demand Waste Prediction</h5>
                    </div>
                    <div class="card-body">
                        <form id="demandWasteForm">
                            <button type="submit" class="btn btn-primary">Predict</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sales Forecasting -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-success text-white">
                        <h5 class="card-title mb-0">Sales Forecasting</h5>
                    </div>
                    <div class="card-body">
                        <form id="salesForecastForm">
                            <button type="submit" class="btn btn-success">Forecast</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recipe Recommendation -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-info text-white">
                        <h5 class="card-title mb-0">Recipe Recommendation</h5>
                    </div>
                    <div class="card-body">
                        <form id="recipeRecommendForm">
                            <button type="submit" class="btn btn-info">Recommend</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-info" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recipe Generation -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="card-title mb-0">Recipe Generation</h5>
                    </div>
                    <div class="card-body">
                        <form id="recipeGenerateForm">
                            <button type="submit" class="btn btn-warning">Generate</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-warning" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cost Optimization -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-danger text-white">
                        <h5 class="card-title mb-0">Cost Optimization</h5>
                    </div>
                    <div class="card-body">
                        <form id="costOptimizeForm">
                            <button type="submit" class="btn btn-danger">Optimize</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-danger" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Spoilage Detection -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="card-title mb-0">Spoilage Detection</h5>
                    </div>
                    <div class="card-body">
                        <form id="spoilageDetectForm">
                            <button type="submit" class="btn btn-secondary">Detect</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-secondary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Tracking -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-dark text-white">
                        <h5 class="card-title mb-0">Inventory Tracking</h5>
                    </div>
                    <div class="card-body">
                        <form id="inventoryTrackForm">
                            <button type="submit" class="btn btn-dark">Track</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-dark" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Waste Classification -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">Waste Classification</h5>
                    </div>
                    <div class="card-body">
                        <form id="wasteClassForm">
                            <button type="submit" class="btn btn-primary">Classify</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Waste Heatmap -->
            <div class="col-md-6 col-lg-4">
                <div class="card module-card">
                    <div class="card-header bg-success text-white">
                        <h5 class="card-title mb-0">Waste Heatmap</h5>
                    </div>
                    <div class="card-body">
                        <form id="wasteHeatmapForm">
                            <button type="submit" class="btn btn-success">Generate</button>
                        </form>
                        <div class="loading mt-3">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <div class="response-area mt-3">
                            <pre class="bg-light p-3 rounded"></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8000/api';

        // Helper function to handle form submissions
        async function handleFormSubmit(formId, endpoint) {
            const form = document.getElementById(formId);
            const loading = form.querySelector('.loading');
            const responseArea = form.querySelector('.response-area pre');
            
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                loading.style.display = 'block';
                responseArea.textContent = '';

                try {
                    const url = `${API_BASE_URL}/${endpoint}`;
                    const options = {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({})
                    };
                    
                    const response = await fetch(url, options);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // Special handling for waste heatmap to display images
                    if (endpoint === 'waste-heatmap' && data.heatmap_url && data.detections_url) {
                        responseArea.innerHTML = `
                            <div class="mb-3">
                                <h6>Heatmap:</h6>
                                <img src="${data.heatmap_url}" class="img-fluid" alt="Heatmap">
                            </div>
                            <div class="mb-3">
                                <h6>Detections:</h6>
                                <img src="${data.detections_url}" class="img-fluid" alt="Detections">
                            </div>
                            <pre class="bg-light p-3 rounded">${JSON.stringify(data, null, 2)}</pre>
                        `;
                    } else {
                        responseArea.textContent = JSON.stringify(data, null, 2);
                    }
                } catch (error) {
                    responseArea.textContent = `Error: ${error.message}`;
                } finally {
                    loading.style.display = 'none';
                }
            });
        }

        // Initialize all forms
        document.addEventListener('DOMContentLoaded', () => {
            handleFormSubmit('demandWasteForm', 'demand-waste-prediction');
            handleFormSubmit('salesForecastForm', 'sales-forecasting');
            handleFormSubmit('recipeRecommendForm', 'recipe-recommendation');
            handleFormSubmit('recipeGenerateForm', 'recipe-generation');
            handleFormSubmit('costOptimizeForm', 'cost-optimization');
            handleFormSubmit('spoilageDetectForm', 'spoilage-detection');
            handleFormSubmit('inventoryTrackForm', 'inventory-tracking');
            handleFormSubmit('wasteClassForm', 'waste-classification');
            handleFormSubmit('wasteHeatmapForm', 'waste-heatmap');
        });
    </script>
</body>
</html> 